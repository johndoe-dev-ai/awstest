|| Step / Component || Description ||
| 1) Authenticate | Users authenticate via *BAM Authentication App*, which is specific to your bank. |
| 2a) Chat Prompt | Authenticated users send a chat prompt from On-Premises to AWS Cloud. |
| 2b) Chat Prompt | The prompt is received by the *React Frontend Service (UI)* hosted in the AWS VPC. |
| Guardrails | Implements safety checks and filters on the chat prompt to ensure security, compliance, or alignment with policies. |
| 3) Validated Prompt | The filtered and validated prompt is passed to the *Python FastAPI Backend Service*. |
| Python FastAPI Backend Service | Handles backend logic, integrates with LlamaIndex, and orchestrates communication with Bedrock and other services. |
| LlamaIndex Agent | Retrieves schema context from the knowledge base to assist in SQL generation. |
| 4) Schema Context | The LlamaIndex Agent pulls schema information from the *Knowledgebase (Vectorstore/OpenSearch)*. |
| Knowledgebase Bucket | Stores markdown files describing database/table info, encrypted using KMS-CMK. |
| Vectorstore Embeddings | Contains precomputed embeddings for schema context, consumed by LlamaIndex. |
| AWS ECS Cluster | Hosts backend services such as FastAPI and LlamaIndex Agent. |
| 5) Send Prompt to LLM and get Response | Validated prompt and schema context are sent to *AWS Bedrock LLMs* to generate the SQL query. |
| 6) SQL Query Execution Result | SQL generated by the LLM is executed via *Athena*, which queries tables defined in the *EDP Central Catalog*. |
| 7) LLM Response | SQL result or response is returned back to the *React Frontend UI*. |
| 8) Store Prompt-Response/Feedback | Stores conversation memory (prompt-response-feedback) in *AWS RDS Postgres*, encrypted using KMS-CMK. |
| 8a) Application Logs | Logs from application services (excluding prompt-response) are pushed to *CloudWatch Logging*. |
| 8b) Infra Logs (e.g., ECS) | Infrastructure-level logs are also sent to *CloudWatch*. |
| CloudWatch Logging | Collects logs from services and infrastructure for observability and auditing. |
| CloudWatch Metrics + Dashboards | Defines metrics and renders dashboards based on logs. |
| 8c) LLM Response Logs | Specific logs related to LLM responses are sent to a *Bedrock Logging Bucket*, encrypted using KMS-CMK. |
